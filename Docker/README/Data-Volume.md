# Docker Volumes 및 Bind Mounts 정리

도커 이미지와 컨테이너의 주요 차이점은 이미지가 **읽기 전용**이라는 점입니다. 이미지는 한 번 생성되면 변경할 수 없으며, 업데이트하려면 이미지를 다시 빌드해야 합니다. 반면, **컨테이너**는 읽기 및 쓰기가 가능합니다. 이는 컨테이너가 이미지 위에 얇은 "읽기-쓰기 레이어"를 추가하여 이미지를 변경하지 않고도 파일과 폴더를 수정할 수 있게 해줍니다.

그러나 읽기-쓰기 가능한 컨테이너에서도 두 가지 문제가 자주 발생합니다:

1. **컨테이너에서 작성된 데이터가 지속되지 않음**: 컨테이너가 중지되고 제거되면, 해당 컨테이너에 기록된 데이터는 모두 손실됩니다.
2. **호스트 파일 시스템과의 상호작용이 불가능함**: 호스트의 프로젝트 폴더에서 무언가를 변경하더라도 실행 중인 컨테이너에 반영되지 않습니다. 이미지를 다시 빌드하고 새 컨테이너를 시작해야 합니다.

첫 번째 문제는 **Volumes(볼륨)**을 사용하여 해결할 수 있으며, 두 번째 문제는 **Bind Mounts(바인드 마운트)**를 사용하여 해결할 수 있습니다.

## Volumes (볼륨)

볼륨은 **호스트 머신**에 저장된 폴더(및 파일)를 컨테이너 내부의 특정 폴더에 연결하는 도커의 기능입니다. 볼륨에는 두 가지 종류가 있습니다:

- **익명 볼륨(Anonymous Volumes)**: `-v /some/path/in/container` 옵션을 사용하여 생성되며, `--rm` 옵션을 사용하여 컨테이너가 제거되면 볼륨도 자동으로 제거됩니다.
- **명명된 볼륨(Named Volumes)**: `-v some-name:/some/path/in/container` 옵션을 사용하여 생성되며, 컨테이너가 제거되더라도 수동으로 제거하지 않는 한 볼륨은 삭제되지 않습니다.

볼륨을 사용하면 데이터를 컨테이너에 전달할 수 있으며, 컨테이너가 기록한 데이터는 호스트 머신에 저장되므로 컨테이너가 제거되더라도 데이터는 보존됩니다.

### 볼륨의 종류 및 사용 방법

- **익명 볼륨(Anonymous Volumes)**: 컨테이너 내부의 폴더가 호스트 머신의 특정 폴더로 덮어씌워지지 않도록 보호하는 데 유용합니다. `--rm` 옵션을 사용하면 컨테이너 중지 시 자동으로 제거됩니다.
- **명명된 볼륨(Named Volumes)**: 로그 파일, 업로드 파일, 데이터베이스 파일 등과 같이 컨테이너에서 생성된 데이터를 영구적으로 보관하는 데 사용됩니다.

### 볼륨 관련 명령어

- `docker volume ls`: 현재 활성화된 모든 볼륨 목록을 확인합니다.
- `docker volume create VOL_NAME`: 새로운 명명된 볼륨을 생성합니다.
- `docker volume rm VOL_NAME`: 이름(또는 ID)으로 특정 볼륨을 제거합니다.
- `docker volume prune`: 사용하지 않는 모든 볼륨을 제거합니다.

## Bind Mounts (바인드 마운트)

바인드 마운트는 볼륨과 유사하지만, **개발자**가 호스트 머신의 경로를 지정하여 컨테이너 내부 경로에 연결합니다. 이를 통해 컨테이너와 호스트 머신 간의 파일 및 폴더 공유가 가능합니다.

- 명령어: `-v /absolute/path/on/your/host/machine:/some/path/inside/of/container`
- 앞에 오는 경로는 **호스트 머신의 절대 경로**여야 합니다.

바인드 마운트는 주로 개발 환경에서 소스 코드를 공유하거나 컨테이너 실행 중에 변경 사항을 반영해야 할 때 유용합니다.

### 바인드 마운트 사용 시 유의점

- 데이터를 영구적으로 보관하려면 바인드 마운트 대신 **명명된 볼륨**을 사용하는 것이 좋습니다.
- 바인드 마운트는 **개발 환경**에서만 사용하고, **프로덕션 환경**에서는 격리된 컨테이너를 사용하는 것이 바람직합니다.

## 주요 Docker 명령어 정리

- `docker run -v /path/in/container IMAGE`: 익명 볼륨을 생성하고 컨테이너 내부에 마운트합니다.
- `docker run -v some-name:/path/in/container IMAGE`: 명명된 볼륨을 생성하고 컨테이너 내부에 마운트합니다.
- `docker run -v /path/on/your/host/machine:path/in/container IMAGE`: 바인드 마운트를 사용하여 호스트 머신의 로컬 경로를 컨테이너 내부 경로에 연결합니다.
- `docker volume ls`: 현재 활성화된 볼륨 목록을 확인합니다.
- `docker volume create VOL_NAME`: 새로운 명명된 볼륨을 생성합니다.
- `docker volume rm VOL_NAME`: 특정 볼륨을 제거합니다.
- `docker volume prune`: 사용되지 않는 모든 볼륨을 제거합니다.

---

이 내용은 도커의 볼륨 및 바인드 마운트의 사용에 대해 설명하며, 개발 환경에서 데이터를 관리하고 컨테이너와 호스트 간 파일 시스템 상호작용을 이해하는 데 유용합니다.
